Program:
  'begin'
    commands*=Command
  'end'
;

Command:
  EncryptCommand | DecryptCommand | ConvertCommand | Assignment | Export | Print | Loop | Condition | Fizzbuzz
;

EncryptCommand:
  'encrypt' algorithm=Algorithm ',' (text=STRING | var=ID)
;

DecryptCommand:
  'decrypt' algorithm=Algorithm ',' (text=STRING | var=ID)
;

ConvertCommand:
  'convert' conversion=Conversions ',' text=STRING
;

Algorithm:
  aes=AES | caesar=Caesar | vigenere=Vigenere | bacon=Bacon | dabish=Dabish
;

AES:
  'aes' key=STRING
;

Bacon:
  'bacon'
;

Vigenere:
  'vigenere' ',' key=STRING
;

Dabish:
  'dabish'
;

Fizzbuzz:
  'fizzbuzz' left=INT ',' right=INT ',' loop=INT
;

Caesar:
  'caesar' ',' key=INT
;

Conversions:
  'base64' | 'decimal' | 'binary' | 'hex'
;

Expression:
  sum=Sum | sub=Sub | product=Product | division=Division | modulo=Modulo | val=INT
;

Assignment:
  'let' var=ID '=' (expression=Expression | encryption=EncryptCommand | decryption=DecryptCommand | value=STRING | value=INT | rvar=ID)
;

Sum:
  (left=ID | left=INT) '+' (right=ID | right=INT)
;

Sub:
  (left=ID | left=INT) '-' (right=ID | right=INT)
;

Product:
  (left=ID | left=INT) '*' (right=ID | right=INT)
;

Division:
  (left=ID | left=INT) '/' (right=ID | right=INT)
;

Modulo:
  (left=ID | left=INT) '%' (right=ID | right=INT)
;

Print:
  'print' (expression=Expression | var=ID | str=STRING)
;

Loop:
  'loop' var=ID ':'
  commands*=Command
  'endloop'
;

Condition:
  'if' (left=ID | left=INT) '==' (right=ID | left=INT) ':'
  commands*=Command
  ('elseif' (leftexpr=Expression | left=ID) '==' right=ID ':'
  commands*=Command)?
  'endif'
;

Export:
  'export' filename=STRING
;
